<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Home - 3CH0</title>
  <meta name="description" content="AI-powered compliance generation for startups and businesses. Get GDPR, CCPA, HIPAA documents in minutes.">
  <meta property="og:title" content="3CH0 ‚Äì AI Compliance Assistant">
  <meta property="og:description" content="Secure your business with AI-generated privacy policies and legal docs.">
  <meta property="og:type" content="website">
  
  <!-- SECURITY HEADERS -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://newsapi.org https://www.paypal.com https://hook.us2.make.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://newsapi.org https://hook.us2.make.com https://api.exchangerate-api.com; frame-src https://www.paypal.com">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta name="robots" content="index, follow">
  
  <link rel="icon" href="3CH0 logo.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    :root {
      --main-bg: #0a0a0a;
      --gradient: linear-gradient(135deg, #ffffff, #92cdec, #0069d9);
      --text-color: #ffffff;
      --button-text: #0a0a0a;
      --card-bg: rgba(20, 20, 20, 0.95);
      --border-color: rgba(255, 255, 255, 0.1);
      --accent: #92cdec;
      --secondary-text: #a0a0a0;
      --glass-panel: rgba(15, 15, 15, 0.8);
      --success: #10b981;
      --warning: #f59e0b;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--main-bg);
      color: var(--text-color);
      line-height: 1.6;
      overflow-x: hidden;
      padding-top: 80px;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* Animated background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(146, 205, 236, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(0, 105, 217, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(146, 205, 236, 0.1) 0%, transparent 50%);
      z-index: -1;
      animation: backgroundShift 20s ease infinite;
    }

    @keyframes backgroundShift {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.1); }
    }

    .main-content {
      flex: 1 0 auto;
      width: 100%;
    }

    .glass-panel {
      background: var(--glass-panel);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    /* Navigation - Fixed */
    nav {
      background: rgba(10, 10, 10, 0.98);
      padding: 18px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border-color);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    nav a {
      margin-left: 24px;
      font-weight: 500;
      color: var(--accent);
      text-decoration: none;
      transition: all 0.3s ease;
      position: relative;
    }

    nav a:hover {
      transform: translateY(-2px);
      color: #fdfdfe;
    }

    nav a::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--gradient);
      transition: width 0.3s ease;
    }

    nav a:hover::after {
      width: 100%;
    }

    .logo-img {
      height: 60px;
      filter: brightness(120%);
    }

    /* Hero Section */
    .hero {
      padding: 100px 20px 60px;
      text-align: center;
      max-width: 1000px;
      margin: 0 auto;
    }

    .hero-content {
      background: var(--glass-panel);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 60px 40px;
      margin: 0 auto;
      max-width: 900px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    .hero h1 {
      font-size: 3.5rem;
      margin-bottom: 20px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-family: 'Playfair Display', serif;
      line-height: 1.2;
      text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .hero p {
      font-size: 1.25rem;
      color: var(--secondary-text);
      max-width: 700px;
      margin: 0 auto 40px;
    }

    .hero-badges {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 40px;
    }

    .badge {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border-color);
      border-radius: 50px;
      padding: 12px 24px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(5px);
    }

    .badge svg {
      width: 18px;
      height: 18px;
      fill: var(--accent);
    }

    /* Benefits Section */
    .benefits {
      padding: 80px 20px;
    }

    .benefits-container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .section-title {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 60px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-family: 'Playfair Display', serif;
    }

    .benefits-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }

    .benefit-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 30px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .benefit-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
    }

    .benefit-icon {
      width: 60px;
      height: 60px;
      background: rgba(146, 205, 236, 0.1);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
    }

    .benefit-icon svg {
      width: 28px;
      height: 28px;
      fill: var(--accent);
    }

    .benefit-card h3 {
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: white;
    }

    .benefit-card p {
      color: var(--secondary-text);
    }

    /* Toggle Form Section */
    .form-toggle-section {
      padding: 40px 0 60px;
      text-align: center;
    }

    .form-toggle-header {
      margin-bottom: 30px;
    }

    .form-toggle-header h2 {
      font-size: 2.5rem;
      margin-bottom: 15px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-family: 'Playfair Display', serif;
    }

    .form-toggle-header p {
      color: var(--secondary-text);
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto;
    }

    .toggle-btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 20px 40px;
      font-size: 18px;
      font-weight: 600;
      color: var(--button-text);
      border: none;
      border-radius: 30px;
      background: var(--gradient);
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.2);
    }

    .toggle-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(146, 205, 236, 0.4);
    }

    .toggle-btn svg {
      transition: transform 0.3s ease;
    }

    .toggle-btn.rotated svg {
      transform: rotate(180deg);
    }

    .form-container {
      max-width: 900px;
      margin: 30px auto 0;
      padding: 40px;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      display: none;
    }

    .form-container.visible {
      display: block;
      animation: fadeIn 0.5s ease forwards;
    }

    /* Regulation Switcher */
    .regulation-switcher {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .regulation-btn {
      padding: 12px 20px;
      border: 2px solid var(--border-color);
      background: var(--card-bg);
      color: var(--secondary-text);
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      flex: 1;
      min-width: 120px;
      text-align: center;
    }

    .regulation-btn.active {
      background: var(--gradient);
      color: var(--button-text);
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(146, 205, 236, 0.3);
    }

    .submission-counter {
      text-align: right;
      font-size: 14px;
      color: #aaa;
      margin-top: -10px;
      margin-bottom: 20px;
    }

    /* Form Grid Layout for Better Organization */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 25px;
    }

    .form-full-width {
      grid-column: 1 / -1;
    }

    /* Field Group Styling */
    .field-group {
      margin-bottom: 25px;
      padding: 20px;
      background: rgba(21, 18, 16, 0.3);
      border-radius: 12px;
      border: 1px solid var(--border-color);
    }

    .field-group-title {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 15px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 8px;
    }

    label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 15px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Required field indicator */
    label[for]::after {
      content: " *";
      color: #ff6b6b;
    }

    input, textarea, select {
      width: 100%;
      padding: 14px;
      border: none;
      border-radius: 10px;
      background-color: rgba(21, 18, 16, 0.7);
      color: var(--text-color);
      font-size: 15px;
      margin-bottom: 20px;
      box-shadow: inset 0 0 0 1px var(--border-color);
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }

    /* Specific styling for different input types */
    input[type="tel"],
    input[type="url"] {
      font-family: monospace;
    }

    textarea {
      min-height: 80px;
      resize: vertical;
      font-family: inherit;
    }

    /* Button design */
    button, .btn, .submit-btn, .pay-btn {
      display: inline-block;
      padding: 16px 40px;
      font-size: 16px;
      font-weight: 600;
      color: var(--button-text);
      border: none;
      border-radius: 30px;
      background: var(--gradient);
      cursor: pointer;
      text-decoration: none;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.2);
    }

    button:hover, .btn:hover, .submit-btn:hover, .pay-btn:hover {
      transform: scale(1.04);
      box-shadow: 0 8px 20px rgba(146, 205, 236, 0.4);
    }

    select {
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="white" viewBox="0 0 140 140" xmlns="http://www.w3.org/2000/svg"><polygon points="70,100 10,40 130,40"/></svg>');
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 10px;
    }

    /* Regulation-specific field styling */
    .regulation-specific {
      background: rgba(146, 205, 236, 0.05);
      border-left: 4px solid var(--accent);
    }

    .field-hidden {
      display: none;
    }

    /* Testimonials */
    .testimonials {
      padding: 80px 20px;
    }

    .testimonials-container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .testimonials-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }

    .testimonial-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 30px;
      position: relative;
      backdrop-filter: blur(10px);
    }

    .testimonial-card::before {
      content: '"';
      font-size: 5rem;
      position: absolute;
      top: 10px;
      left: 20px;
      opacity: 0.1;
      font-family: 'Playfair Display', serif;
      line-height: 1;
    }

    .testimonial-text {
      color: var(--secondary-text);
      margin-bottom: 20px;
      position: relative;
      z-index: 1;
    }

    .testimonial-author {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .author-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--accent);
    }

    .author-details h4 {
      margin: 0;
      font-size: 1rem;
    }

    .author-details p {
      margin: 0;
      color: var(--secondary-text);
      font-size: 0.9rem;
    }

    /* Process Steps */
    .process-steps {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
      margin: 40px 0;
    }

    .process-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 30px 25px;
      text-align: center;
      width: 250px;
      min-height: 280px;
      display: flex;
      flex-direction: column;
      align-items: center;
      backdrop-filter: blur(10px);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .process-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
    }

    .process-number {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--gradient);
      color: var(--button-text);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
    }

    .process-card h3 {
      font-size: 18px;
      margin: 0 0 15px 0;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .process-card p {
      color: var(--secondary-text);
      font-size: 14px;
      line-height: 1.5;
      margin: 0;
    }

    .process-arrow {
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
    }

    /* News Section */
    .news-section {
      padding: 80px 20px;
    }

    .news-container-wrapper {
      max-width: 1200px;
      margin: 0 auto;
    }

    .news-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .news-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
    }

    .news-card {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      overflow: hidden;
      transition: transform 0.3s ease;
      backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
    }

    .news-card:hover {
      transform: translateY(-5px);
    }

    .news-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
      border-bottom: 1px solid var(--border-color);
    }

    .news-content {
      padding: 20px;
    }

    .news-title {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 10px 0;
    }

    .news-title a {
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-decoration: none;
    }

    .news-desc {
      font-size: 14px;
      color: #bbb;
      margin: 0 0 15px 0;
      line-height: 1.5;
    }

    .news-meta {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #888;
    }

    /* CTA Section */
    .cta-section {
      padding: 100px 20px;
      text-align: center;
      background: linear-gradient(to bottom, transparent 0%, rgba(15, 14, 13, 0.9) 100%);
    }

    .cta-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .cta-title {
      font-size: 2.5rem;
      margin-bottom: 20px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-family: 'Playfair Display', serif;
    }

    .cta-text {
      color: var(--secondary-text);
      font-size: 1.1rem;
      margin-bottom: 40px;
    }

    .cta-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn-secondary {
      background: transparent;
      border: 2px solid var(--accent);
      color: var(--accent);
    }

    /* Cookie Consent Banner */
    .cookie-consent {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(15, 14, 13, 0.95);
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
      border-top: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
    }
    
    .cookie-consent p {
      margin: 0;
      color: var(--secondary-text);
      flex: 1;
      padding-right: 20px;
    }
    
    .cookie-consent button {
      padding: 10px 20px;
      white-space: nowrap;
    }
    
    /* Security Badges */
    .security-badges {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    
    .security-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border-color);
      border-radius: 50px;
      padding: 8px 16px;
      font-size: 14px;
    }
    
    .security-badge svg {
      width: 16px;
      height: 16px;
      fill: var(--accent);
    }
    
    /* Rate limiting message */
    .rate-limit-message {
      display: none;
      background: rgba(255, 100, 100, 0.1);
      border: 1px solid rgba(255, 100, 100, 0.3);
      border-radius: 8px;
      padding: 12px;
      margin: 15px 0;
      text-align: center;
      color: #ff6b6b;
    }

    .legal-disclaimer {
      background: rgba(255, 183, 77, 0.1);
      border: 1px solid rgba(255, 183, 77, 0.3);
      border-radius: 12px;
      padding: 20px;
      margin: 25px 0;
      display: flex;
      gap: 15px;
      backdrop-filter: blur(5px);
    }
  
    .disclaimer-icon {
      font-size: 24px;
      flex-shrink: 0;
      margin-top: 4px;
    }
  
    .disclaimer-content h4 {
      margin: 0 0 10px 0;
      color: #ffb74d;
      font-size: 16px;
    }
  
    .disclaimer-content p {
      margin: 0 0 10px 0;
      font-size: 14px;
      color: #ccc;
      line-height: 1.5;
    }
  
    .disclaimer-content p:last-child {
      margin-bottom: 0;
    }

    /* Footer - At Bottom */
    footer {
      padding: 40px 20px;
      background-color: rgba(9, 6, 3, 0.9);
      text-align: center;
      font-size: 14px;
      color: #777;
      border-top: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
      flex-shrink: 0;
      width: 100%;
    }

    footer a {
      color: #ccc;
      text-decoration: underline;
      margin: 0 8px;
    }

    .footer-links {
      margin-bottom: 20px;
    }

    /* Animation */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .animate {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }
    
    .animate.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Responsive */
    @media (max-width: 768px) {
      nav {
        padding: 15px 20px;
      }
      
      .hero h1 {
        font-size: 2.5rem;
      }
      
      .hero p {
        font-size: 1.1rem;
      }
      
      .form-container {
        padding: 30px 20px;
      }
      
      .cta-buttons {
        flex-direction: column;
        align-items: center;
      }
      
      .benefits-grid,
      .testimonials-grid,
      .news-grid {
        grid-template-columns: 1fr;
      }
      
      .toggle-btn {
        padding: 16px 30px;
        font-size: 16px;
      }
      
      body {
        padding-top: 70px;
      }
      
      footer {
        padding: 30px 15px;
      }

      .process-steps {
        flex-direction: column;
        gap: 30px;
      }
      
      .process-arrow {
        transform: rotate(90deg);
      }
      
      .process-card {
        width: 100%;
        max-width: 300px;
        min-height: 240px;
      }

      .regulation-switcher {
        flex-direction: column;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Loading States */
    .loading-skeleton {
      height: 280px;
      border-radius: 12px;
      background: linear-gradient(90deg, rgba(255,255,255,0.03) 25%, rgba(255,255,255,0.08) 50%, rgba(255,255,255,0.03) 75%);
      background-size: 400% 100%;
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      0% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .rotating {
      animation: rotate 1s linear infinite;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Security Badge - Subtle */
    .security-badge-indicator {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 10px;
      color: var(--success);
      z-index: 1000;
      backdrop-filter: blur(10px);
    }
  </style>
</head>

<body>
  <div class="main-content">
    <!-- Nav - Fixed -->
    <nav class="glass-panel">
      <div><img src="3CH0_logo_transparent_fixed.png" alt="3CH0 Logo" class="logo-img"></div>
      <div>
        <a href="home.html">Home</a>
        <a href="subscription.html">Subscription</a>
        <a href="settings.html">Settings</a>
      </div>
    </nav>

    <!-- Hero Section with Glass Panel -->
    <section class="hero">
      <div class="hero-content">
        <h1 class="animate">Enterprise-Grade Compliance for Growing Businesses</h1>
        <p class="animate">AI-powered compliance solutions that save time, reduce risk, and scale with your business. Generate legally-compliant documents in minutes, not days.</p>
        
        <div class="hero-badges animate">
          <div class="badge">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
            GDPR, CCPA, HIPAA, POPIA Compliant
          </div>
          <div class="badge">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
            Auto-Update with Law Changes
          </div>
        </div>
      </div>
    </section>

    <!-- Benefits Section -->
    <section class="benefits">
      <div class="benefits-container">
        <h2 class="section-title animate">Why Choose 3CH0 Compliance?</h2>
        
        <div class="benefits-grid">
          <div class="benefit-card glass-panel animate">
            <div class="benefit-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9.29 16.29L5.7 12.7c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0L10 14.17l6.88-6.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-7.59 7.59c-.38.39-1.02.39-1.41 0z"/></svg>
            </div>
            <h3>Save 90% on Legal Costs</h3>
            <p>Generate comprehensive compliance documents at a fraction of the cost of hiring legal experts.</p>
          </div>
          
          <div class="benefit-card glass-panel animate">
            <div class="benefit-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
            </div>
            <h3>Generate in Minutes</h3>
            <p>What used to take lawyers weeks now takes our AI minutes. Get compliant faster and focus on your business.</p>
          </div>
          
          <div class="benefit-card glass-panel animate">
            <div class="benefit-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
            </div>
            <h3>Stay Updated Automatically</h3>
            <p>We monitor legal changes globally and automatically update your documents to maintain compliance.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Toggle Form Section -->
    <section class="form-toggle-section">
      <div class="form-toggle-header">
        <h2>Ready to Get Compliant?</h2>
        <p>Generate custom compliance documents tailored to your business in minutes with our simple 3-step process</p>
      </div>
      
      <!-- 3-Step Process -->
      <div class="process-steps">
        <div class="process-card">
          <div class="process-number">1</div>
          <h3>Complete Our Simple Form</h3>
          <p>Provide basic information about your business, data practices, and compliance needs.</p>
        </div>
        
        <div class="process-arrow">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M8 12H16M16 12L13 9M16 12L13 15" stroke="#92cdec" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        
        <div class="process-card">
          <div class="process-number">2</div>
          <h3>AI Generates Your Documents</h3>
          <p>Our specialized algorithms create customized, legally-sound compliance documentation templates.</p>
        </div>
        
        <div class="process-arrow">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M8 12H16M16 12L13 9M16 12L13 15" stroke="#92cdec" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        
        <div class="process-card">
          <div class="process-number">3</div>
          <h3>Download & Implement Immediately</h3>
          <p>Receive your complete compliance package ready for immediate use in your business.</p>
        </div>
      </div>
      
      <br>
      <br>

      <button id="toggle-form-btn" class="toggle-btn">
        <span>Generate Compliance Documents</span>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
        
      <div id="form-container" class="form-container glass-panel">
        <!-- Regulation Switcher -->
        <div class="regulation-switcher">
          <button type="button" class="regulation-btn active" data-regulation="GDPR">GDPR</button>
          <button type="button" class="regulation-btn" data-regulation="CCPA">CCPA</button>
          <button type="button" class="regulation-btn" data-regulation="HIPAA">HIPAA</button>
          <button type="button" class="regulation-btn" data-regulation="POPIA">POPIA</button>
        </div>

        <div class="submission-counter">
          Submissions left this month: <strong id="submissions-count">1</strong>
          <small title="For free users only. Paid users get unlimited submissions.">[‚àû]</small>
        </div>

        <form id="ComplianceFormWebhook">
          <input type="hidden" name="form-name" value="ComplianceFormWebhook" />
          <input type="hidden" id="selected_regulation" name="selected_regulation" value="GDPR">

          <!-- Honeypot Field -->
          <div style="display: none;">
            <label for="website">Website</label>
            <input type="text" id="website" name="website" autocomplete="off">
          </div>

          <!-- COMPANY INFORMATION -->
          <div class="field-group">
            <div class="field-group-title">Company Information</div>
            
            <label for="company">Company Name</label>
            <input type="text" id="company" name="company" required>

            <label for="company_address">Company Address</label>
            <textarea id="company_address" name="company_address" rows="2" required placeholder="Full business address including street, city, state, zip code"></textarea>

            <div class="form-grid">
              <div>
                <label for="phone_number">Business Phone Number</label>
                <input type="tel" id="phone_number" name="phone_number" required placeholder="+1 (555) 123-4567">
              </div>
              <div>
                <label for="website_url">Company Website</label>
                <input type="url" id="website_url" name="website_url" required placeholder="https://yourcompany.com">
              </div>
            </div>

            <div class="form-grid">
              <div>
                <label for="industry">Industry</label>
                <select name="industry" id="industry" required>
                  <option value="">Select</option>
                  <option>SaaS</option>
                  <option>FinTech</option>
                  <option>E-Commerce</option>
                  <option>HealthTech</option>
                  <option>Other</option>
                </select>
              </div>
              <div>
                <label for="location">Business Location</label>
                <input type="text" id="location" name="location" required placeholder="e.g., California, USA or European Union">
              </div>
            </div>
          </div>

          <!-- CONTACT INFORMATION -->
          <div class="field-group">
            <div class="field-group-title">Contact Information</div>
            
            <label for="email">Compliance Contact Email</label>
            <input type="email" id="email" name="email" required>

            <div class="form-grid">
              <div>
                <label for="privacy_officer">Privacy Officer Name</label>
                <input type="text" id="privacy_officer" name="privacy_officer" required placeholder="Name of privacy officer or contact person">
              </div>
              <div id="security_officer_container" class="field-hidden">
                <label for="security_officer">Security Officer Name (For HIPAA)</label>
                <input type="text" id="security_officer" name="security_officer" placeholder="Name of security officer">
              </div>
            </div>

            <div class="form-grid">
              <div id="dpo_name_container" class="field-hidden">
                <label for="dpo_name">Data Protection Officer (For GDPR)</label>
                <input type="text" id="dpo_name" name="dpo_name" placeholder="Name of Data Protection Officer">
              </div>
              <div>
                <label for="authorized_signatory">Authorized Signatory Name</label>
                <input type="text" id="authorized_signatory" name="authorized_signatory" required placeholder="Name of person authorized to sign documents">
              </div>
            </div>

            <!-- POPIA Information Officer -->
            <div id="information_officer_container" class="field-hidden">
              <label for="information_officer">Information Officer (For POPIA)</label>
              <input type="text" id="information_officer" name="information_officer" placeholder="Name of Information Officer">
            </div>
          </div>

          <!-- COMPLIANCE FOCUS -->
          <div class="field-group">
            <div class="field-group-title">Compliance Focus</div>
            
            <label for="regulations">Compliance Focus</label>
            <select name="regulations" id="regulations" required>
              <option value="">Select</option>
              <option>GDPR</option>
              <option>CCPA</option>
              <option>HIPAA</option>
              <option>POPIA</option>
              <option>Multiple / Global</option>
            </select>

            <label for="data">What type of user or business data do you collect?</label>
            <textarea name="data" id="data" rows="3" required placeholder="E.g., names, emails, health info, purchase history"></textarea>

            <label for="thirdparty">List any third-party tools or platforms used</label>
            <textarea name="thirdparty" id="thirdparty" rows="3" required placeholder="E.g., Google Analytics, Stripe, Firebase"></textarea>

            <label for="service_provider_name">Primary Service Provider/Vendor (For DPAs)</label>
            <input type="text" id="service_provider_name" name="service_provider_name" required placeholder="Main vendor for Data Processing Agreements">
          </div>

          <!-- DOCUMENTS NEEDED -->
          <div class="field-group">
            <div class="field-group-title">Document Selection</div>
            
            <label for="docs-needed">Which document do you need?</label>
            <select name="docs" id="docs-needed" required>
              <option value="">Select one document</option>
              <option value="Privacy Policy">Privacy Policy</option>
              <option value="Data Processing Agreement">Data Processing Agreement</option>
              <option value="Employee Training Script">Employee Training Script</option>
              <option value="Audit-Ready Documentation">Audit-Ready Documentation</option>
            </select>

            <label for="updates">Would you like real-time legal update tracking included?</label>
            <select name="updates" id="updates" required>
              <option value="">Select</option>
              <option value="Yes">Yes, auto-update my documents</option>
              <option value="No">No, one-time compliance only</option>
            </select>

            <div id="trainer_name_container" class="field-hidden">
              <label for="trainer_name">Training Coordinator Name (For Training Scripts)</label>
              <input type="text" id="trainer_name" name="trainer_name" placeholder="Name of person conducting employee training">
            </div>

            <!-- CCPA Specific Fields -->
            <div id="ccpa_specific" class="field-hidden regulation-specific">
              <label for="toll_free_number">Toll-Free Number (For CCPA)</label>
              <input type="tel" id="toll_free_number" name="toll_free_number" placeholder="+1-800-XXX-XXXX">
              
              <label for="opt_out_mechanism">Opt-Out Mechanism Description</label>
              <textarea id="opt_out_mechanism" name="opt_out_mechanism" rows="2" placeholder="Describe how consumers can opt-out of data sales"></textarea>
            </div>

            <!-- HIPAA Specific Fields -->
            <div id="hipaa_specific" class="field-hidden regulation-specific">
              <label for="covered_entity_type">Covered Entity Type (For HIPAA)</label>
              <select id="covered_entity_type" name="covered_entity_type">
                <option value="">Select</option>
                <option>Healthcare Provider</option>
                <option>Health Plan</option>
                <option>Healthcare Clearinghouse</option>
                <option>Business Associate</option>
              </select>
              
              <label for="phi_categories">PHI Categories Handled</label>
              <textarea id="phi_categories" name="phi_categories" rows="2" placeholder="Describe categories of Protected Health Information handled"></textarea>
            </div>

            <!-- POPIA Specific Fields -->
            <div id="popia_specific" class="field-hidden regulation-specific">
              <label for="paia_manual_url">PAIA Manual URL (For POPIA)</label>
              <input type="url" id="paia_manual_url" name="paia_manual_url" placeholder="https://yourcompany.com/paia-manual">
              
              <label for="direct_marketing_consent">Direct Marketing Consent Mechanism</label>
              <textarea id="direct_marketing_consent" name="direct_marketing_consent" rows="2" placeholder="Describe your direct marketing consent process"></textarea>
            </div>
          </div>

          <!-- LEGAL DISCLAIMER -->
          <div class="legal-disclaimer">
            <div class="disclaimer-icon">‚ö†Ô∏è</div>
            <div class="disclaimer-content">
              <h4>Important Legal Disclaimer</h4>
              <p>This AI-generated compliance documentation has not been verified by legal authorities or a legal team. 
              We recommend having all documents reviewed by a qualified legal professional before implementation.</p>
              <p>3CH0 provides these templates as a starting point only and does not constitute legal advice. 
              By using our service, you acknowledge that you understand these documents should be reviewed by 
              appropriate legal counsel for your specific situation.</p>
              
              <p>Please Note, we are currently seeking legal partnership to verify our documents so that 
                we can become your number one trusted regulation helper.</p>
            </div>
          </div>

          <br><br>
          <button type="submit" class="submit-btn">Generate My AI Compliance Pack</button>
        </form>
      </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials">
      <div class="testimonials-container">
        <h2 class="section-title">Trusted By Industry Leaders</h2>
        
        <div class="testimonials-grid">
          <div class="testimonial-card glass-panel">
            <div class="testimonial-author">
              <img src="Sarah.png" alt="Sarah K." class="author-avatar">
              <div class="author-details">
                <h4>Sarah K.</h4>
                <p>E-commerce Founder</p>
              </div>
            </div>
            <p class="testimonial-text">"We had no clue how to handle GDPR. 3CH0 generated our docs in 15 minutes and passed audit on first try!"</p>
          </div>
          
          <div class="testimonial-card glass-panel">
            <div class="testimonial-author">
              <img src="Mark.png" alt="Mark T." class="author-avatar">
              <div class="author-details">
                <h4>Mark T.</h4>
                <p>FinTech Advisor</p>
              </div>
            </div>
            <p class="testimonial-text">"Saved my clients $3,000+ in legal fees. Now my first recommendation to every startup I mentor."</p>
          </div>
          
          <div class="testimonial-card glass-panel">
            <div class="testimonial-author">
              <img src="Priya.png" alt="Priya M." class="author-avatar">
              <div class="author-details">
                <h4>Priya M.</h4>
                <p>HealthTech CTO</p>
              </div>
            </div>
            <p class="testimonial-text">"The audit-ready documentation saved us 3 weeks of prep work before our Series A funding round."</p>
          </div>
        </div>
      </div>
    </section>

    <!-- News Section -->
    <section class="news-section">
      <div class="news-container-wrapper">
        <div class="news-header">
          <h2 class="section-title">Global Business and Compliance News</h2>
        </div>
        
        <div id="news-container" class="news-grid">
          <!-- Loading state -->
          <div class="loading-skeleton"></div>
          <div class="loading-skeleton" style="animation-delay: 0.2s;"></div>
          <div class="loading-skeleton" style="animation-delay: 0.4s;"></div>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
          <button id="refresh-news-btn" class="btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M22 12C22 17.52 17.52 22 12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2C15.76 2 19 3.89 20.9 6.86M22 12H18M12 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Refresh Business News
          </button>
        </div>
      </div>
    </section>

    <!-- Security Badges Section -->
    <div class="security-badges">
      <div class="security-badge">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>
        <span>SSL Secured</span>
      </div>
      <div class="security-badge">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
        <span>GDPR Compliant</span>
      </div>
      <div class="security-badge">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM15.1 8H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>
        <span>Data Encrypted</span>
      </div>
    </div>
  
    <!-- CTA Section -->
    <section class="cta-section">
      <div class="cta-container">
        <h2 class="cta-title">Ready to Simplify Compliance?</h2>
        <p class="cta-text">Join hundreds of businesses that trust 3CH0 for their compliance needs. Generate your first document today.</p>
        
        <div class="cta-buttons">
          <a href="#form-container" class="btn" id="cta-generate-btn">Generate Compliance Pack</a>
          <a href="subscription.html" class="btn btn-secondary">View Pricing Plans</a>
        </div>
      </div>
    </section>

    <!-- Cookie Consent Banner -->
    <div id="cookieConsent" class="cookie-consent" style="display: none;">
      <p>We use cookies to ensure you get the best experience on our website and to analyze traffic. By continuing to use our site, you accept our use of cookies.</p>
      <button onclick="acceptCookies()" class="btn">Accept</button>
    </div>
    
    <!-- Rate limiting message (initially hidden) -->
    <div id="rateLimitMessage" class="rate-limit-message">
      <strong>Submission Limit Reached</strong><br>
      You've reached the maximum number of submissions. Please try again later or upgrade your plan.
    </div>
  </div>

  <!-- Footer - At Bottom -->
  <footer>
    <div class="footer-links">
      <a href="settings.html">Privacy & Terms</a> |
      <a href="mailto:3CH0.The.Only@gmail.com">Support</a> |
      <a href="https://discord.gg/W5SrbqK7j3" target="_blank">Join the Community</a>
    </div>
    &copy; 2025 3CH0 Compliance. All rights reserved.
  </footer>

  <!-- Security Badge -->
  <div class="security-badge-indicator">üîí Secure</div>

  <script>
    // ======================
    // REGULATION SWITCHER LOGIC
    // ======================
    class RegulationSwitcher {
      constructor() {
        this.currentRegulation = 'GDPR';
        this.initializeSwitcher();
      }

      initializeSwitcher() {
        const regulationBtns = document.querySelectorAll('.regulation-btn');
        const hiddenRegulationField = document.getElementById('selected_regulation');

        regulationBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            const regulation = btn.getAttribute('data-regulation');
            this.switchRegulation(regulation, btn);
            hiddenRegulationField.value = regulation;
          });
        });

        // Initialize for GDPR
        this.switchRegulation('GDPR', document.querySelector('.regulation-btn[data-regulation="GDPR"]'));
      }

      switchRegulation(regulation, clickedBtn) {
        // Update active button
        document.querySelectorAll('.regulation-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        clickedBtn.classList.add('active');

        this.currentRegulation = regulation;
        this.updateFormFields(regulation);
      }

      updateFormFields(regulation) {
        // Hide all regulation-specific fields first
        document.querySelectorAll('[id$="_container"], [id$="_specific"]').forEach(el => {
          el.classList.add('field-hidden');
        });

        // Reset all regulation-specific required fields
        document.querySelectorAll('[id$="_container"] input, [id$="_specific"] input, [id$="_specific"] select, [id$="_specific"] textarea').forEach(field => {
          field.removeAttribute('required');
        });

        // Show fields based on regulation
        switch(regulation) {
          case 'GDPR':
            document.getElementById('dpo_name_container').classList.remove('field-hidden');
            document.getElementById('dpo_name').setAttribute('required', 'true');
            break;
          
          case 'CCPA':
            document.getElementById('ccpa_specific').classList.remove('field-hidden');
            document.getElementById('toll_free_number').setAttribute('required', 'true');
            document.getElementById('opt_out_mechanism').setAttribute('required', 'true');
            break;
          
          case 'HIPAA':
            document.getElementById('security_officer_container').classList.remove('field-hidden');
            document.getElementById('hipaa_specific').classList.remove('field-hidden');
            document.getElementById('security_officer').setAttribute('required', 'true');
            document.getElementById('covered_entity_type').setAttribute('required', 'true');
            document.getElementById('phi_categories').setAttribute('required', 'true');
            break;
          
          case 'POPIA':
            document.getElementById('information_officer_container').classList.remove('field-hidden');
            document.getElementById('popia_specific').classList.remove('field-hidden');
            document.getElementById('information_officer').setAttribute('required', 'true');
            document.getElementById('paia_manual_url').setAttribute('required', 'true');
            document.getElementById('direct_marketing_consent').setAttribute('required', 'true');
            break;
        }

        // Update training field based on document selection
        this.updateTrainingField(document.getElementById('docs-needed').value);
      }

      updateTrainingField(selectedDoc) {
        const trainerContainer = document.getElementById('trainer_name_container');
        const trainerInput = document.getElementById('trainer_name');
        
        if (selectedDoc === 'Employee Training Script') {
          trainerContainer.classList.remove('field-hidden');
          trainerInput.setAttribute('required', 'true');
        } else {
          trainerContainer.classList.add('field-hidden');
          trainerInput.removeAttribute('required');
        }
      }
    }

    // ======================
    // ENHANCED FORM HANDLER WITH REGULATION SUPPORT
    // ======================
    const SecureFormHandler = {
      formStartTime: null,
      regulationSwitcher: null,

      init() {
        this.formStartTime = Date.now();
        this.regulationSwitcher = new RegulationSwitcher();
        this.addCSRFToken();
        this.initializeFormHandler();
        this.initializeSecurityMonitoring();
        
        SecurityUtils.logSecurityEvent('page_loaded', {
          page: 'home',
          formStartTime: this.formStartTime
        });
      },

      addCSRFToken() {
        const form = document.getElementById('ComplianceFormWebhook');
        if (form) {
          const csrfToken = SecurityUtils.generateCSRFToken();
          let csrfField = form.querySelector('input[name="csrf_token"]');
          
          if (!csrfField) {
            csrfField = document.createElement('input');
            csrfField.type = 'hidden';
            csrfField.name = 'csrf_token';
            csrfField.value = csrfToken;
            form.appendChild(csrfField);
          } else {
            csrfField.value = csrfToken;
          }
        }
      },

      initializeFormHandler() {
        const form = document.getElementById('ComplianceFormWebhook');
        if (form) {
          form.addEventListener('submit', (e) => this.handleSecureSubmit(e));
          this.addInputSanitization(form);
          
          // Add document type change listener
          document.getElementById('docs-needed').addEventListener('change', (e) => {
            this.regulationSwitcher.updateTrainingField(e.target.value);
          });
        }
      },

      addInputSanitization(form) {
        const inputs = form.querySelectorAll('input, textarea, select');
        inputs.forEach(input => {
          input.addEventListener('blur', (e) => {
            if (e.target.value) {
              e.target.value = SecurityUtils.sanitizeInput(e.target.value);
            }
          });
        });
      },

      async handleSecureSubmit(e) {
        e.preventDefault();
        const form = e.target;
        
        const securityChecks = this.performSecurityChecks(form);
        if (!securityChecks.isValid) {
          this.showSecurityError(securityChecks.errors);
          return;
        }

        const formData = this.prepareSecureFormData(form);
        await this.submitToMakeWebhook(formData);
      },

      performSecurityChecks(form) {
        const errors = [];
        const now = Date.now();
        const formFillTime = now - this.formStartTime;

        if (formFillTime < SECURITY_CONFIG.minFormFillTime) {
          errors.push('Form submitted too quickly');
        }

        if (formFillTime > SECURITY_CONFIG.maxFormFillTime) {
          errors.push('Form session expired');
        }

        if (this.isRateLimited()) {
          errors.push('Rate limit exceeded');
        }

        const csrfToken = form.querySelector('input[name="csrf_token"]')?.value;
        if (!csrfToken || !SecurityUtils.validateCSRFToken(csrfToken)) {
          errors.push('Security token invalid');
        }

        // Honeypot check
        const honeypot = form.querySelector('input[name="website"]')?.value;
        if (honeypot && honeypot.length > 0) {
          errors.push('Spam detection triggered');
        }

        const requiredFields = form.querySelectorAll('[required]');
        requiredFields.forEach(field => {
          if (!field.value.trim()) {
            errors.push(`${field.name} is required`);
          }
        });

        return {
          isValid: errors.length === 0,
          errors: errors
        };
      },

      prepareSecureFormData(form) {
        const formData = new FormData(form);
        const secureData = {
          regulation: document.getElementById('selected_regulation').value,
          document_type: document.getElementById('docs-needed').value,
          company_info: {
            company_name: document.getElementById('company').value,
            company_address: document.getElementById('company_address').value,
            phone_number: document.getElementById('phone_number').value,
            website_url: document.getElementById('website_url').value,
            industry: document.getElementById('industry').value,
            location: document.getElementById('location').value
          },
          contact_info: {
            email: document.getElementById('email').value,
            privacy_officer: document.getElementById('privacy_officer').value,
            security_officer: document.getElementById('security_officer').value || null,
            dpo_name: document.getElementById('dpo_name').value || null,
            authorized_signatory: document.getElementById('authorized_signatory').value,
            information_officer: document.getElementById('information_officer').value || null
          },
          compliance_data: {
            data_collected: document.getElementById('data').value,
            third_party_tools: document.getElementById('thirdparty').value,
            service_provider: document.getElementById('service_provider_name').value
          },
          regulation_specific: {
            toll_free_number: document.getElementById('toll_free_number').value || null,
            opt_out_mechanism: document.getElementById('opt_out_mechanism').value || null,
            covered_entity_type: document.getElementById('covered_entity_type').value || null,
            phi_categories: document.getElementById('phi_categories').value || null,
            paia_manual_url: document.getElementById('paia_manual_url').value || null,
            direct_marketing_consent: document.getElementById('direct_marketing_consent').value || null
          }
        };
        
        secureData.security_metadata = {
          submission_time: new Date().toISOString(),
          user_agent: navigator.userAgent,
          form_fill_time: Date.now() - this.formStartTime,
          ip_hash: this.hashUserData(navigator.userAgent + window.location.href)
        };
        
        return secureData;
      },

      async submitToMakeWebhook(formData) {
        try {
          this.setLoadingState(true);
          
          const response = await fetch(SECURITY_CONFIG.webhookUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
          });

          if (response.ok) {
            SecurityUtils.logSecurityEvent('form_submission_success', {
              regulation: formData.regulation,
              document_type: formData.document_type
            });
            
            // Update submission counter
            this.updateSubmissionCounter();
            
            window.location.href = "bank-invoice.html";
          } else {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
        } catch (error) {
          SecurityUtils.logSecurityEvent('form_submission_error', {
            error: error.message
          });
          this.showError('Submission failed. Please try again.');
        } finally {
          this.setLoadingState(false);
        }
      },

      updateSubmissionCounter() {
        const now = new Date();
        const storageKey = `submissions-${now.getMonth()}-${now.getFullYear()}`;
        const currentCount = parseInt(localStorage.getItem(storageKey) || SECURITY_CONFIG.freeSubmissions);
        const newCount = currentCount - 1;
        
        localStorage.setItem(storageKey, newCount);
        document.getElementById('submissions-count').textContent = newCount;
        
        if (newCount <= 0) {
          document.getElementById('rateLimitMessage').style.display = 'block';
        }
      },

      isRateLimited() {
        const lastSubmission = localStorage.getItem('lastSubmissionTime');
        const now = Date.now();
        
        if (lastSubmission && (now - lastSubmission) < SECURITY_CONFIG.rateLimitPeriod) {
          return true;
        }
        
        localStorage.setItem('lastSubmissionTime', now);
        return false;
      },

      hashUserData(data) {
        let hash = 0;
        for (let i = 0; i < data.length; i++) {
          const char = data.charCodeAt(i);
          hash = ((hash << 5) - hash) + char;
          hash = hash & hash;
        }
        return Math.abs(hash).toString(16);
      },

      showSecurityError(errors) {
        const errorHtml = `
          <div class="error-message" style="
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #dc3545;
          ">
            <strong>Security Check Failed:</strong>
            <ul style="margin: 10px 0 0 0; padding-left: 20px;">
              ${errors.map(error => `<li>${error}</li>`).join('')}
            </ul>
          </div>
        `;
        
        const existingError = document.querySelector('.error-message');
        if (existingError) {
          existingError.remove();
        }
        
        const form = document.getElementById('ComplianceFormWebhook');
        form.insertAdjacentHTML('afterbegin', errorHtml);
      },

      showError(message) {
        alert(message);
      },

      setLoadingState(loading) {
        const submitBtn = document.querySelector('.submit-btn');
        if (submitBtn) {
          submitBtn.disabled = loading;
          submitBtn.textContent = loading ? 'Generating Documents...' : 'Generate My AI Compliance Pack';
          submitBtn.style.opacity = loading ? '0.7' : '1';
        }
      },

      initializeSecurityMonitoring() {
        document.addEventListener('click', (e) => {
          SecurityUtils.logSecurityEvent('user_click', {
            element: e.target.tagName,
            text: e.target.textContent?.substring(0, 50)
          });
        });

        document.addEventListener('input', (e) => {
          if (e.target.form?.id === 'ComplianceFormWebhook') {
            SecurityUtils.logSecurityEvent('form_input', {
              field: e.target.name,
              value_length: e.target.value.length
            });
          }
        });
      }
    };

    // ======================
    // SECURITY CONFIGURATION & UTILITIES (Keep existing)
    // ======================
    const SECURITY_CONFIG = {
        webhookUrl: 'https://hook.us2.make.com/rxu5mdjft2evqirbr9w1rvcqlkvnxslu',
        newsApiKey: 'f639d0fd3bd742a3a179f80f0c23edb5',
        
        // Security Settings
        enableCSRF: true,
        enableInputSanitization: true,
        enableRateLimiting: true,
        enableActivityMonitoring: true,
        
        // Rate Limiting
        freeSubmissions: 1,
        rateLimitPeriod: 3600000,
        maxFormFillTime: 30000,
        minFormFillTime: 3000
    };

    const SecurityUtils = {
        generateCSRFToken() {
            const token = btoa(Date.now() + '-' + Math.random().toString(36) + '-' + navigator.userAgent);
            localStorage.setItem('csrf_token', token);
            localStorage.setItem('csrf_timestamp', Date.now().toString());
            return token;
        },

        validateCSRFToken(token) {
            const storedToken = localStorage.getItem('csrf_token');
            const timestamp = localStorage.getItem('csrf_timestamp');
            const now = Date.now();
            
            if (!storedToken || !timestamp || (now - parseInt(timestamp)) > 86400000) {
                return false;
            }
            
            return storedToken === token;
        },

        sanitizeInput(input) {
            if (typeof input !== 'string') return input;
            
            return input
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#x27;')
                .replace(/`/g, '&#x60;')
                .trim();
        },

        validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        },

        validateURL(url) {
            try {
                new URL(url);
                return true;
            } catch {
                return false;
            }
        },

        logSecurityEvent(eventType, details) {
            const eventData = {
                type: eventType,
                timestamp: new Date().toISOString(),
                url: window.location.href,
                userAgent: navigator.userAgent,
                details: details
            };
            
            console.log('üîí Security Event:', eventData);
            
            fetch(SECURITY_CONFIG.webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    security_event: true,
                    ...eventData
                })
            }).catch(console.error);
        }
    };

    // ======================
    // EXISTING FUNCTIONALITY (Keep existing)
    // ======================
    function checkCookieConsent() {
        if (!localStorage.getItem('cookiesAccepted')) {
            document.getElementById('cookieConsent').style.display = 'flex';
        }
    }
    
    function acceptCookies() {
        localStorage.setItem('cookiesAccepted', 'true');
        document.getElementById('cookieConsent').style.display = 'none';
        SecurityUtils.logSecurityEvent('cookies_accepted', {});
    }
    
    function checkRateLimit() {
        const lastSubmission = localStorage.getItem('lastSubmissionTime');
        const now = Date.now();
        
        if (lastSubmission && (now - lastSubmission) < SECURITY_CONFIG.rateLimitPeriod) {
            document.getElementById('rateLimitMessage').style.display = 'block';
            return true;
        }
        
        document.getElementById('rateLimitMessage').style.display = 'none';
        return false;
    }

    async function loadBusinessNews() {
        const newsContainer = document.getElementById('news-container');
        const refreshBtn = document.getElementById('refresh-news-btn');
        
        try {
            newsContainer.innerHTML = `
                <div class="loading-skeleton"></div>
                <div class="loading-skeleton" style="animation-delay: 0.2s;"></div>
                <div class="loading-skeleton" style="animation-delay: 0.4s;"></div>
            `;
            
            refreshBtn.innerHTML = `
                <svg class="rotating" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 12C22 17.52 17.52 22 12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2C15.76 2 19 3.89 20.9 6.86M22 12H18M12 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Loading Business News...
            `;
            
            const response = await fetch(
                `https://newsapi.org/v2/top-headlines?category=business&language=en&pageSize=3&apiKey=${SECURITY_CONFIG.newsApiKey}`
            );
            
            if (!response.ok) throw new Error('Failed to fetch news');
            const data = await response.json();
            
            newsContainer.innerHTML = '';
            
            data.articles.forEach(article => {
                const newsCard = document.createElement('div');
                newsCard.className = 'news-card glass-panel';
                newsCard.innerHTML = `
                    ${article.urlToImage ? `
                        <img src="${article.urlToImage}" alt="${article.title}" class="news-image" onerror="this.style.display='none'">
                    ` : ''}
                    <div class="news-content">
                        <h3 class="news-title">
                            <a href="${article.url}" target="_blank" rel="noopener noreferrer">${article.title || 'Business Update'}</a>
                        </h3>
                        <p class="news-desc">${article.description || 'Latest global business news'}</p>
                        <div class="news-meta">
                            <span>${article.source?.name || 'Source'}</span>
                            <span>${new Date(article.publishedAt).toLocaleDateString()}</span>
                        </div>
                    </div>
                `;
                newsContainer.appendChild(newsCard);
            });
            
        } catch (error) {
            console.error("News error:", error);
            newsContainer.innerHTML = `
                <div style="grid-column:1/-1; text-align:center; padding:30px; color:#ccc;">
                    <h3 style="margin-top:0;">‚ö†Ô∏è News Feed Temporarily Unavailable</h3>
                    <p>We couldn't load the latest updates. Please try again later.</p>
                    <button onclick="loadBusinessNews()" class="btn" style="margin-top:15px;">Retry</button>
                </div>
            `;
        } finally {
            refreshBtn.innerHTML = `
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 12C22 17.52 17.52 22 12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2C15.76 2 19 3.89 20.9 6.86M22 12H18M12 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Refresh Business News
            `;
        }
    }

    // ======================
    // INITIALIZE EVERYTHING
    // ======================
    document.addEventListener("DOMContentLoaded", function() {
        // Initialize submission counter
        const now = new Date();
        const storageKey = `submissions-${now.getMonth()}-${now.getFullYear()}`;
        const currentCount = localStorage.getItem(storageKey) || SECURITY_CONFIG.freeSubmissions;
        document.getElementById('submissions-count').textContent = currentCount;

        // Initialize secure form handler with regulation switcher
        SecureFormHandler.init();
        
        // Initialize existing functionality
        checkCookieConsent();
        checkRateLimit();
        
        // Load news
        loadBusinessNews();
        
        // Animation on scroll
        const animateElements = document.querySelectorAll('.animate');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.1 });
        
        animateElements.forEach(el => {
            observer.observe(el);
        });

        // CTA button handlers
        document.getElementById('cta-generate-btn').addEventListener('click', (e) => {
            e.preventDefault();
            const formContainer = document.getElementById('form-container');
            const toggleFormBtn = document.getElementById('toggle-form-btn');
            
            if (!formContainer.classList.contains('visible')) {
                formContainer.classList.add('visible');
                toggleFormBtn.classList.add('rotated');
            }
            formContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });

        // Toggle form handler
        document.getElementById('toggle-form-btn').addEventListener('click', () => {
            const formContainer = document.getElementById('form-container');
            const toggleFormBtn = document.getElementById('toggle-form-btn');
            
            formContainer.classList.toggle('visible');
            toggleFormBtn.classList.toggle('rotated');
            
            if (formContainer.classList.contains('visible')) {
                formContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });
    });

    // Manual refresh handler for news
    document.getElementById('refresh-news-btn').addEventListener('click', loadBusinessNews);

    // Session timeout for data clearing
    let inactivityTimer;
    function resetInactivityTimer() {
        clearTimeout(inactivityTimer);
        inactivityTimer = setTimeout(() => {
            localStorage.removeItem('invoiceClientData');
            localStorage.removeItem('currentInvoice');
            console.log('Session data cleared due to inactivity');
        }, 30 * 60 * 1000);
    }

    document.addEventListener('mousemove', resetInactivityTimer);
    document.addEventListener('keypress', resetInactivityTimer);
    document.addEventListener('click', resetInactivityTimer);
    resetInactivityTimer();
  </script>
</body>
</html>
